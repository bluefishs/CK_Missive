# ç’°å¢ƒè®Šæ•¸ç®¡ç†æœ€ä½³å¯¦è¸æŒ‡å—

## ğŸ¯ ç›®æ¨™
è§£æ±ºç’°å¢ƒè®Šæ•¸åˆ†æ•£ç®¡ç†ã€å¿«å–å•é¡Œå’Œé…ç½®ä¸ä¸€è‡´çš„å•é¡Œã€‚

## ğŸ“ æª”æ¡ˆçµæ§‹

```
frontend/
â”œâ”€â”€ .env                    # åŸºç¤é…ç½®ï¼Œé©ç”¨æ‰€æœ‰ç’°å¢ƒ
â”œâ”€â”€ .env.local             # æœ¬åœ°è¦†è“‹é…ç½® (Gitå¿½ç•¥)
â”œâ”€â”€ .env.development       # é–‹ç™¼ç’°å¢ƒç‰¹å®šé…ç½®
â”œâ”€â”€ .env.production        # ç”Ÿç”¢ç’°å¢ƒç‰¹å®šé…ç½®
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ env-manager.js     # ç’°å¢ƒè®Šæ•¸ç®¡ç†å·¥å…·
â””â”€â”€ .husky/
    â””â”€â”€ pre-commit         # Gitæäº¤å‰æª¢æŸ¥
```

## ğŸ”§ ç®¡ç†ç­–ç•¥

### 1. **çµ±ä¸€åŸºç¤é…ç½®**
æ‰€æœ‰å…±ç”¨é…ç½®æ”¾åœ¨ `.env` æª”æ¡ˆä¸­ï¼š
```bash
# APIé…ç½®
VITE_API_BASE_URL=/api

# æ‡‰ç”¨è³‡è¨Š
VITE_APP_TITLE=ä¹¾å¤æ¸¬ç¹ªå…¬æ–‡ç®¡ç†ç³»çµ±
VITE_APP_VERSION=2.0.0

# Google OAuthé…ç½®
VITE_GOOGLE_CLIENT_ID=482047526162-c91akhidlog5kheed42b8cfqv2g2qls5.apps.googleusercontent.com
```

### 2. **ç’°å¢ƒç‰¹å®šè¦†è“‹**
åªåœ¨ç‰¹å®šæª”æ¡ˆä¸­è¦†è“‹éœ€è¦æ”¹è®Šçš„å€¼ï¼š

**.env.development:**
```bash
# é–‹ç™¼ç’°å¢ƒç‰¹å®š
VITE_ENABLE_DEVTOOLS=true
VITE_ENABLE_DEBUG=true
```

**.env.production:**
```bash
# ç”Ÿç”¢ç’°å¢ƒç‰¹å®š
VITE_ENABLE_DEVTOOLS=false
VITE_ENABLE_DEBUG=false
```

### 3. **æœ¬åœ°é–‹ç™¼è¦†è“‹**
å‰µå»º `.env.local` (ä¸æäº¤åˆ°Git)ï¼š
```bash
# æœ¬åœ°é–‹ç™¼å¯èƒ½éœ€è¦çš„ç‰¹æ®Šé…ç½®
# VITE_API_BASE_URL=http://localhost:8001/api
```

## ğŸ› ï¸ å·¥å…·ä½¿ç”¨

### ç’°å¢ƒè®Šæ•¸ç®¡ç†å·¥å…·
```bash
# æª¢æŸ¥é…ç½®
cd frontend && node scripts/env-manager.js validate

# ä¿®å¾©å¸¸è¦‹å•é¡Œ
cd frontend && node scripts/env-manager.js fix
```

### æ¸…æ½”æ§‹å»º
```bash
# åŸ·è¡Œå®Œå…¨æ¸…æ½”æ§‹å»º
./scripts/docker-build-clean.sh
```

## ğŸš« é¿å…å¿«å–å•é¡Œ

### 1. **Dockerå±¤é¢**
```bash
# å®Œå…¨æ¸…æ½”é‡å»º
docker-compose down frontend
docker rmi ck_missive-frontend
docker builder prune -f
docker-compose build --no-cache frontend
```

### 2. **Viteå±¤é¢**
```bash
# æ¸…ç†Viteå¿«å–
rm -rf node_modules/.vite
rm -rf dist
```

### 3. **ç€è¦½å™¨å±¤é¢**
- ä½¿ç”¨ç¡¬é‡æ–°æ•´ç†ï¼š`Ctrl+Shift+R`
- æ¸…é™¤ç€è¦½å™¨å¿«å–
- ä½¿ç”¨ç„¡ç—•æ¨¡å¼æ¸¬è©¦

## âœ… æª¢æŸ¥æ¸…å–®

### é–‹ç™¼å‰
- [ ] ç¢ºèª `.env` åŒ…å«æ‰€æœ‰åŸºç¤é…ç½®
- [ ] ç¢ºèªæ²’æœ‰ç¡¬ç·¨ç¢¼çš„localhost URLs
- [ ] é‹è¡Œç’°å¢ƒè®Šæ•¸é©—è­‰å·¥å…·

### éƒ¨ç½²å‰
- [ ] åŸ·è¡Œæ¸…æ½”æ§‹å»º
- [ ] ç¢ºèªç·¨è­¯å¾Œæª”æ¡ˆç„¡8002ç¡¬ç·¨ç¢¼
- [ ] æ¸¬è©¦æ‰€æœ‰ç’°å¢ƒé…ç½®

### Gitæäº¤å‰
- [ ] pre-commit hooksæœƒè‡ªå‹•æª¢æŸ¥
- [ ] ç¢ºèªç„¡æ•æ„Ÿè³‡è¨Šåœ¨ç’°å¢ƒè®Šæ•¸æª”æ¡ˆä¸­

## ğŸ” æ•…éšœæ’é™¤

### å•é¡Œï¼šå‰ç«¯ä»é€£æ¥éŒ¯èª¤ç«¯å£
**è§£æ±ºæ­¥é©Ÿï¼š**
1. `node scripts/env-manager.js validate`
2. æª¢æŸ¥æ‰€æœ‰ `.env.*` æª”æ¡ˆ
3. åŸ·è¡Œæ¸…æ½”é‡å»º
4. æ¸…ç†ç€è¦½å™¨å¿«å–

### å•é¡Œï¼šDockeræ§‹å»ºä½¿ç”¨èˆŠé…ç½®
**è§£æ±ºæ­¥é©Ÿï¼š**
1. `docker builder prune -f`
2. `rm -rf frontend/dist`
3. `docker build --no-cache`

### å•é¡Œï¼šç’°å¢ƒè®Šæ•¸æœªç”Ÿæ•ˆ
**æª¢æŸ¥é †åºï¼š**
1. Viteæ¨¡å¼æ˜¯å¦æ­£ç¢º (`development`/`production`)
2. è®Šæ•¸æ˜¯å¦ä»¥ `VITE_` é–‹é ­
3. æª”æ¡ˆè¼‰å…¥å„ªå…ˆç´šæ˜¯å¦ç¬¦åˆé æœŸ

## ğŸ“‹ æœ€ä½³å¯¦è¸åŸå‰‡

1. **å–®ä¸€ä¾†æºçœŸå¯¦æ€§**ï¼šåŸºç¤é…ç½®é›†ä¸­åœ¨ `.env`
2. **æœ€å°å·®ç•°åŸå‰‡**ï¼šç’°å¢ƒç‰¹å®šæª”æ¡ˆåªåŒ…å«å·®ç•°
3. **è‡ªå‹•åŒ–é©—è­‰**ï¼šä½¿ç”¨å·¥å…·å’Œhooksé˜²æ­¢éŒ¯èª¤
4. **æ¸…æ½”æ§‹å»º**ï¼šå®šæœŸåŸ·è¡Œå®Œå…¨æ¸…æ½”é‡å»º
5. **æ–‡æª”åŒ–**ï¼šæ‰€æœ‰ç’°å¢ƒè®Šæ•¸éƒ½è¦æœ‰è¨»é‡‹èªªæ˜

## ğŸš€ éƒ¨ç½²æµç¨‹

```bash
# 1. é©—è­‰é…ç½®
cd frontend && node scripts/env-manager.js validate

# 2. æ¸…æ½”æ§‹å»º
./scripts/docker-build-clean.sh

# 3. é©—è­‰çµæœ
docker exec ck_missive_frontend sh -c "grep -r '8002' /usr/share/nginx/html/ || echo 'âœ… ç„¡ç¡¬ç·¨ç¢¼ç«¯å£'"

# 4. æ¸¬è©¦åŠŸèƒ½
# è¨ªå• http://localhost:3000 é€²è¡ŒåŠŸèƒ½æ¸¬è©¦
```

é€™å¥—æµç¨‹å¯ä»¥æœ‰æ•ˆé¿å…ç’°å¢ƒè®Šæ•¸ç®¡ç†æ··äº‚å’Œå¿«å–å•é¡Œï¼