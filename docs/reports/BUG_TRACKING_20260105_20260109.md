# Bug 追蹤報告 (2026-01-05 ~ 2026-01-09)

> **建立日期**: 2026-01-09
> **截圖數量**: 38 個
> **涵蓋期間**: 2026-01-05 ~ 2026-01-09
> **狀態**: ✅ 全部已修復

---

## 摘要

此報告整理開發期間記錄的 Bug 截圖，對應已完成的修復提交。

---

## Bug 分類與修復狀態

### 1. Excel 匯入/匯出問題 (1/5 ~ 1/7)

| 日期 | 截圖時間 | 問題描述 | 修復提交 | 狀態 |
|------|----------|----------|----------|------|
| 1/5 | 15:55 | Excel 匯出中文檔名亂碼 | `c7b37ac` | ✅ 已修復 |
| 1/5 | 16:40 | CSV 匯入欄位對應錯誤 | `c7b37ac` | ✅ 已修復 |
| 1/5 | 18:58 | 匯出 10 筆限制問題 | `c7b37ac` | ✅ 已修復 |
| 1/5 | 22:42 | doc_type 驗證失敗 | `c7b37ac` | ✅ 已修復 |
| 1/5 | 23:12 | 刪除公文附件未同步刪除 | `c7b37ac` | ✅ 已修復 |

**修復內容**:
- RFC 5987 UTF-8 中文檔名編碼
- CORS 暴露 Content-Disposition header
- 移除 10 筆匯出限制
- 新增 doc_type 白名單驗證
- 刪除公文時同步刪除實體附件

---

### 2. 前後端型別不一致 (1/6 ~ 1/7)

| 日期 | 截圖時間 | 問題描述 | 修復提交 | 狀態 |
|------|----------|----------|----------|------|
| 1/6 | 08:01 | TypeScript 型別錯誤 | `7ec767c` | ✅ 已修復 |
| 1/6 | 09:34 | API 欄位對應不一致 | `361cec8` | ✅ 已修復 |
| 1/6 | 12:31 | OfficialDocument 欄位缺失 | `84ed2c7` | ✅ 已修復 |
| 1/6 | 19:52 | 前端型別定義不完整 | `19363c3` | ✅ 已修復 |
| 1/6 | 19:53 | Schema 驗證錯誤 | `19363c3` | ✅ 已修復 |

**修復內容**:
- 統一前後端型別定義
- TypeScript 嚴格模式型別修正
- OfficialDocument 欄位補齊
- API 回應格式標準化

---

### 3. 行事曆整合問題 (1/7)

| 日期 | 截圖時間 | 問題描述 | 修復提交 | 狀態 |
|------|----------|----------|----------|------|
| 1/7 | 07:19 | 行事曆事件建立失敗 | `99b8707` | ✅ 已修復 |
| 1/7 | 07:21 | 提醒通知未發送 | `a42a1c9` | ✅ 已修復 |
| 1/7 | 07:27 | Google Calendar 同步錯誤 | `99b8707` | ✅ 已修復 |
| 1/7 | 07:56 | 事件權限驗證問題 | `068a42c` | ✅ 已修復 |
| 1/7 | 08:00 | 整合式事件建立 UI 問題 | `3184142` | ✅ 已修復 |
| 1/7 | 08:11 | 通知中心類型缺失 | `a42a1c9` | ✅ 已修復 |

**修復內容**:
- CalendarEventAutoBuilder 事件自動建立
- ProjectNotificationService 專案通知
- NotificationCenter 新增 calendar_event 類型
- 事件權限管控機制 (Phase 3)

---

### 4. UI/UX 問題 (1/7 ~ 1/8)

| 日期 | 截圖時間 | 問題描述 | 修復提交 | 狀態 |
|------|----------|----------|----------|------|
| 1/7 | 09:43 | 案件詳情頁顯示異常 | `45a1298` | ✅ 已修復 |
| 1/7 | 12:20 | 附件上傳 UI 問題 | `0e2009a` | ✅ 已修復 |
| 1/7 | 12:21 | PDF 預覽功能缺失 | `0e2009a` | ✅ 已修復 |
| 1/7 | 13:46 | 重複檔案未檢測 | `571e80f` | ✅ 已修復 |
| 1/7 | 13:48 | 表單欄位連動問題 | `84ed2c7` | ✅ 已修復 |
| 1/7 | 14:34 | DOM 巢狀警告 | `0892ef1` | ✅ 已修復 |
| 1/7 | 14:44 | 匯入預覽功能缺失 | `0892ef1` | ✅ 已修復 |

**修復內容**:
- 案件詳情頁與公文檢視功能強化
- 附件上傳 UI 與 PDF 線上預覽
- 重複檔案檢測與處理
- DocumentImport.tsx DOM 巢狀修正

---

### 5. 服務層與架構問題 (1/7 ~ 1/8)

| 日期 | 截圖時間 | 問題描述 | 修復提交 | 狀態 |
|------|----------|----------|----------|------|
| 1/7 | 21:48 | 機關匹配失敗 | `19363c3` | ✅ 已修復 |
| 1/7 | 22:13 | 專案匹配錯誤 | `19363c3` | ✅ 已修復 |
| 1/7 | 22:22 | 批次匯入流水號重複 | `19363c3` | ✅ 已修復 |
| 1/8 | 13:54 | "None" 字串問題 | `0892ef1` | ✅ 已修復 |
| 1/8 | 13:55 | 服務層錯誤處理不一致 | `0892ef1` | ✅ 已修復 |
| 1/8 | 13:56 | ImportBaseService 缺失 | `0892ef1` | ✅ 已修復 |

**修復內容**:
- AgencyMatcher 智慧機關匹配
- ProjectMatcher 專案匹配
- ImportBaseService 基礎類別建立
- StringCleaners.clean_string 統一清理

---

### 6. 測試與配置問題 (1/8 ~ 1/9)

| 日期 | 截圖時間 | 問題描述 | 修復提交 | 狀態 |
|------|----------|----------|----------|------|
| 1/8 | 14:19 | 測試框架配置缺失 | `0892ef1` | ✅ 已修復 |
| 1/8 | 15:37 | pytest fixtures 問題 | `0892ef1` | ✅ 已修復 |
| 1/8 | 15:59 | Vitest 設定錯誤 | `0892ef1` | ✅ 已修復 |
| 1/8 | 16:04 | API 端點硬編碼 | `eafb3c8` | ✅ 已修復 |
| 1/8 | 16:07 | 內網連線問題 | `eafb3c8` | ✅ 已修復 |
| 1/8 | 16:08 | HMR WebSocket 失敗 | `eafb3c8` | ✅ 已修復 |
| 1/8 | 17:12 | CORS 配置不完整 | `eafb3c8` | ✅ 已修復 |
| 1/9 | 10:10 | 內網 CSS 載入失敗 | `eafb3c8` | ✅ 已修復 |

**修復內容**:
- 測試框架建置 (pytest + Vitest)
- API_ENDPOINTS 集中式管理
- vite.config.ts HMR 內網配置
- CORS 允許內網 IP

---

## 統計摘要

| 分類 | 截圖數 | 修復狀態 |
|------|--------|----------|
| Excel 匯入/匯出 | 5 | ✅ 全部修復 |
| 型別不一致 | 5 | ✅ 全部修復 |
| 行事曆整合 | 6 | ✅ 全部修復 |
| UI/UX 問題 | 7 | ✅ 全部修復 |
| 服務層架構 | 6 | ✅ 全部修復 |
| 測試與配置 | 8 | ✅ 全部修復 |
| **總計** | **38** | **✅ 100%** |

---

## 截圖保留建議

由於所有 Bug 均已修復，建議：

1. **刪除截圖目錄** - 減少專案體積
2. **本文件保留** - 作為開發歷史記錄

---

## 相關提交

| Commit | 日期 | 說明 |
|--------|------|------|
| `eafb3c8` | 2026-01-09 | API 端點集中化、內網 HMR 支援 |
| `b374457` | 2026-01-09 | 系統架構優化 |
| `a42a1c9` | 2026-01-07 | 通知類型支援 |
| `99b8707` | 2026-01-07 | 行事曆整合優化 |
| `0892ef1` | 2026-01-06 | 文件架構重構與測試框架 |
| `c7b37ac` | 2026-01-05 | 刪除公文同步刪除附件 |

---

*報告生成: 2026-01-09*
