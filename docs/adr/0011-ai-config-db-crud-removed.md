# ADR-0011: AI 配置 DB CRUD 系統移除 — 超前開發教訓

> **狀態**: removed
> **日期**: 2026-02-27
> **決策者**: 開發團隊
> **關聯**: CHANGELOG v1.65.0

## 背景

2026-02-08，團隊建置了一套完整的 DB-backed CRUD 系統，目的是讓管理員透過 Web UI 管理 AI Prompt 模板與同義詞字典，無需修改後端 YAML 檔案。完整架構包含：

- **DB 資料表**：`ai_prompt_versions`（Prompt 版本管理）與 `ai_synonyms`（同義詞管理）
- **9 個 API 端點**：5 個同義詞 + 4 個 Prompt CRUD
- **Repository 層**：`AISynonymRepository` + `AIPromptRepository`
- **前端頁面**：2 個完整 CRUD 管理頁面（合計約 1,100 行），搭配 React Query hooks
- **三層 Fallback 機制**：DB 啟用版本 → YAML 檔案 → 內建預設值

架構設計本身是合理的：`AIPromptManager.get_system_prompt()` 依序檢查 DB、YAML、硬編碼預設值，確保系統始終有可用的配置。

## 決策

2026-02-27，將「AI 配置」Tab 從管理頁面移除（5 個 Tab → 4 個 Tab），原因如下：

1. **兩張 DB 資料表自建立以來（19 天）均為 0 筆資料**——從未有人使用
2. **YAML 檔案已足夠**：`prompts.yaml`（6 個模板，含詳細 few-shot 範例）與 `synonyms.yaml`（66 組同義詞），開發者直接編輯即可
3. **沒有管理員需要 Web UI**——撰寫 Prompt 需要開發者專業知識，維護同義詞需要領域知識，兩者都不適合透過通用 CRUD 介面操作
4. **空殼 UI 降低信任感**——Tab 打開後只顯示「暫無資料」的空表格

**移除範圍**：僅移除 `AIAssistantManagementPage.tsx` 中的 Tab 渲染。

**保留範圍**：所有後端 API、Repository、ORM 模型、前端頁面元件均保留，以備未來有明確需求時可快速恢復。

## 後果

### 正面

- 架構完整保留，若未來確實需要 Web 管理可在數分鐘內恢復 Tab
- 三層 Fallback 機制設計良好，即使 DB 有資料也不影響 YAML 回退
- 管理頁面更簡潔，減少使用者困惑

### 負面

- 約 1,100 行前端 + 400 行後端 + 2 張 DB 資料表 = 大量未使用的程式碼殘留在 codebase 中
- 開發時間浪費（估計 4-6 小時建置完整 CRUD 系統）
- 保留的程式碼仍需隨專案演進維護（型別更新、依賴升級等）

## 替代方案

| 方案 | 評估 |
|------|------|
| 完全刪除所有相關程式碼 | 風險過高，若未來需求出現需全部重建 |
| 保留 Tab 但標記為「Beta」 | 空殼 UI 仍會降低使用者信任 |
| 改為唯讀展示（顯示 YAML 內容） | 這才是應該最初採取的 MVP 方案 |
| 維持現狀不變 | 空 Tab 佔用螢幕空間，無實際價值 |

## 教訓

這是一個「超前開發」（Premature Implementation）的經典案例。技術實作完全正確，但缺少以下關鍵驗證步驟：

1. **需求驗證**：「管理員需要透過 Web UI 管理 Prompt」——但管理員是誰？使用頻率如何？是否真的需要 Web 介面？
2. **MVP 驗證**：應先建立唯讀顯示（展示 YAML 目前內容），確認有人使用後再投入 CRUD 開發
3. **資料來源分析**：YAML 作為開發者管理的配置檔已足夠，DB CRUD 解決的是一個不存在的問題

### 防範措施

- 建立功能前應在 ADR 中記錄需求來源與預期使用者
- 使用 `proposed` → `accepted` 的 ADR 狀態流程，在實作前取得明確確認
- 大型功能先建 MVP（唯讀/最小可用版本），以實際使用數據驗證需求後再完整實作
- 定期檢視 DB 資料表使用狀況，識別零使用的功能
