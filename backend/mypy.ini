# =============================================================================
# CK_Missive Backend - MyPy Configuration
# =============================================================================
# 用途: Python 靜態型別檢查
# 執行: mypy app --config-file mypy.ini
# =============================================================================

[mypy]
# Python 版本
python_version = 3.11

# 要檢查的套件
packages = app

# 基本設定
warn_return_any = True
warn_unused_configs = True
warn_redundant_casts = True
warn_unused_ignores = True
show_error_codes = True
show_column_numbers = True
pretty = True

# 漸進式嚴格模式 (第一階段: 寬鬆)
# 未來可逐步啟用更嚴格的檢查
disallow_untyped_defs = False
disallow_incomplete_defs = False
check_untyped_defs = True

# 忽略缺少型別的第三方套件
ignore_missing_imports = True

# 排除的路徑
exclude = (?x)(
    ^app/alembic/  # Alembic 遷移
    | ^app/scripts/  # 腳本
    | ^tests/  # 測試
    )

# =============================================================================
# 第三方套件特定配置
# =============================================================================

[mypy-sqlalchemy.*]
ignore_missing_imports = True

[mypy-alembic.*]
ignore_missing_imports = True

[mypy-celery.*]
ignore_missing_imports = True

[mypy-redis.*]
ignore_missing_imports = True

[mypy-jose.*]
ignore_missing_imports = True

[mypy-google.*]
ignore_missing_imports = True

[mypy-pandas.*]
ignore_missing_imports = True

[mypy-openpyxl.*]
ignore_missing_imports = True

[mypy-asyncpg.*]
ignore_missing_imports = True

[mypy-groq.*]
ignore_missing_imports = True

[mypy-ollama.*]
ignore_missing_imports = True

# =============================================================================
# 專案模組特定配置
# =============================================================================

# 核心模組 - 嚴格檢查
[mypy-app.core.*]
disallow_untyped_defs = False
warn_return_any = True

# API 端點 - 中等檢查
[mypy-app.api.*]
disallow_untyped_defs = False

# 服務層 - 中等檢查
[mypy-app.services.*]
disallow_untyped_defs = False

# Repository 層 - 嚴格檢查
[mypy-app.repositories.*]
disallow_untyped_defs = False
warn_return_any = True

# Schemas - 嚴格檢查 (Pydantic models)
[mypy-app.schemas.*]
disallow_untyped_defs = False
