#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” æª¢æŸ¥ç’°å¢ƒè®Šæ•¸é…ç½®..."

# æª¢æŸ¥æ˜¯å¦æœ‰8002ç¡¬ç·¨ç¢¼
if grep -r "localhost:8002" . --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=dist --exclude=pre-commit; then
  echo "âŒ ç™¼ç¾ç¡¬ç·¨ç¢¼çš„8002ç«¯å£ï¼Œè«‹ä¿®å¾©å¾Œå†æäº¤"
  exit 1
fi

# æª¢æŸ¥ç’°å¢ƒè®Šæ•¸æª”æ¡ˆ
if [ -f "scripts/env-manager.js" ]; then
  node scripts/env-manager.js validate
  if [ $? -ne 0 ]; then
    echo "âŒ ç’°å¢ƒè®Šæ•¸é©—è­‰å¤±æ•—ï¼Œè«‹ä¿®å¾©å¾Œå†æäº¤"
    exit 1
  fi
fi

echo "âœ… ç’°å¢ƒè®Šæ•¸æª¢æŸ¥é€šé"
